

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick Start &mdash; troposphere 2.4.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/troposphere_favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="examples" href="apis/examples_toc.html" />
    <link rel="prev" title="troposphere" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/troposphere_logo_small.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cloudformation-basics">CloudFormation Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apis/examples_toc.html">examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="apis/troposphere_toc.html">troposphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="apis/tests_toc.html">tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html#releasing">Releasing</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">troposphere</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Quick Start</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<p>Troposphere closely follows CloudFormation, so there isn’t much documentation
specific to Troposphere.  In this documentation there are various examples but
for the most part the CloudFormation docs should be used.</p>
<div class="section" id="cloudformation-basics">
<h2>CloudFormation Basics<a class="headerlink" href="#cloudformation-basics" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-anatomy.html">Template Anatomy</a>
- structure of a CloudFormation template.</p></li>
<li><p><a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-anatomy.html">Resources</a>
are the basic blocks and required in any template.</p></li>
<li><p><a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/outputs-section-structure.html">Outputs</a>
are optional but can be used to create cross-stack references. Having everything
in one stack will make it very hard to manage the infrastructure.  Instead,
values from one stack (for example, network setup) can be exported in this
section and <a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-importvalue.html">imported</a>
by another stack (for example, EC2 setup). This way a stack used to set up a
certain application can be managed or deleted without affecting other
applications that might be present on the same network.</p></li>
<li><p><a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference.html">Intrinsic Functions</a>
should be used to manipulate values that are only available at runtime. For
example, assume a template that creates a subnet and attaches a routing table
and network ACL to that subnet. The subnet doesn’t exist when the template is
created, so it’s ID can’t be known. Instead, the route and network ACL resources
are going to get the ID at runtime, by using the
<a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a>
function against the subnet.</p></li>
</ul>
</div>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>The following two pieces of code are intended to demonstrate basic usage of
Troposphere and CloudFormation templates. First template will create two subnets
and export their IDs. The second one will create an EC2 instance in one of the
subnets. The comments explain how it works and where to find documentation
regarding the use of CloudFormation and Troposphere.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1">#</span>
<span class="c1"># learncf_subnet.py</span>
<span class="c1">#</span>
<span class="c1"># Generate a CloudFormation template that will create two subnets. This</span>
<span class="c1"># template exports the subnet IDs to be used by a second template which</span>
<span class="c1"># will create an EC2 instance in one of those subnets.</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">from</span> <span class="nn">troposphere</span> <span class="kn">import</span> <span class="n">ec2</span>
<span class="kn">from</span> <span class="nn">troposphere</span> <span class="kn">import</span> <span class="n">Tags</span><span class="p">,</span> <span class="n">GetAtt</span><span class="p">,</span> <span class="n">Ref</span><span class="p">,</span> <span class="n">Sub</span><span class="p">,</span> <span class="n">Export</span>
<span class="kn">from</span> <span class="nn">troposphere</span> <span class="kn">import</span> <span class="n">Template</span><span class="p">,</span> <span class="n">Output</span>

<span class="c1"># Create the object that will generate our template</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Template</span><span class="p">()</span>

<span class="c1"># Define resources that CloudFormation will generate for us</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resources-section-structure.html</span>

<span class="c1"># Define the first subnet. We know that &#39;Subnet()&#39; is in the ec2 module</span>
<span class="c1"># because in CloudFormation the Subnet resource is defined under EC2:</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html</span>
<span class="n">net_learncf_1a</span> <span class="o">=</span> <span class="n">ec2</span><span class="o">.</span><span class="n">Subnet</span><span class="p">(</span><span class="s2">&quot;netLearnCf1a&quot;</span><span class="p">)</span>

<span class="c1"># Information about the possible properties of Subnet() can be found</span>
<span class="c1"># in CloudFormation docs:</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html#aws-resource-ec2-subnet-properties</span>
<span class="n">net_learncf_1a</span><span class="o">.</span><span class="n">AvailabilityZone</span> <span class="o">=</span> <span class="s2">&quot;eu-west-1a&quot;</span>
<span class="n">net_learncf_1a</span><span class="o">.</span><span class="n">CidrBlock</span> <span class="o">=</span> <span class="s2">&quot;172.30.126.80/28&quot;</span>            <span class="c1"># ADJUST THIS VALUE</span>
<span class="n">net_learncf_1a</span><span class="o">.</span><span class="n">VpcId</span> <span class="o">=</span> <span class="s2">&quot;vpc-abcdefgh&quot;</span>                    <span class="c1"># ADJUST THIS VALUE</span>
<span class="c1"># Tags can be declared in two ways. One way is</span>
<span class="c1"># (1) in AWS/boto format, as a list of dictionaries where each item in the</span>
<span class="c1"># list has (at least) two elements. The &quot;Key&quot; key will be the tag key and</span>
<span class="c1"># the &quot;Value&quot; key will be the tag&#39;s Value. Confusing, but it allows for</span>
<span class="c1"># additional settings to be specified for each tag. For example, if a tag</span>
<span class="c1"># attached to an autoscaling group should be inherited by the EC2 instances</span>
<span class="c1"># the group launches or not.</span>
<span class="n">net_learncf_1a</span><span class="o">.</span><span class="n">Tags</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="s2">&quot;learncf-1a&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="s2">&quot;Comment&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="s2">&quot;CloudFormation+Troposphere test&quot;</span><span class="p">}]</span>

<span class="c1"># The subnet resource defined above must be added to the template</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">net_learncf_1a</span><span class="p">)</span>

<span class="c1"># The same thing can be achieved by setting parameters to Subnet() function</span>
<span class="c1"># instead of properties of the object created by Subnet(). Shown below.</span>
<span class="c1">#</span>
<span class="c1"># For the second subnet we use the other method of defining tags,</span>
<span class="c1"># (2) by using the Tags helper function, which is defined in Troposphere</span>
<span class="c1"># and doesn&#39;t have an equivalent in CloudFormation.</span>
<span class="c1">#</span>
<span class="c1"># Also, we use GetAtt to read the value of an attribute from a previously</span>
<span class="c1"># created resource, i.e. VPC ID from the first subnet. For demo purposes.</span>
<span class="c1">#</span>
<span class="c1"># The attributes returned by each resource can be found in the CloudFormation</span>
<span class="c1"># documentation, in the Returns section for that resource:</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html#aws-resource-ec2-subnet-getatt</span>
<span class="c1">#</span>
<span class="c1"># GetAtt documentation:</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-getatt.html</span>
<span class="n">net_learncf_1b</span> <span class="o">=</span> <span class="n">ec2</span><span class="o">.</span><span class="n">Subnet</span><span class="p">(</span>
        <span class="s2">&quot;netLearnCf1b&quot;</span><span class="p">,</span>
        <span class="n">AvailabilityZone</span><span class="o">=</span><span class="s2">&quot;eu-west-1b&quot;</span><span class="p">,</span>
        <span class="n">CidrBlock</span><span class="o">=</span><span class="s2">&quot;172.30.126.96/28&quot;</span><span class="p">,</span>                   <span class="c1"># ADJUST THIS VALUE</span>
        <span class="n">VpcId</span><span class="o">=</span><span class="n">GetAtt</span><span class="p">(</span><span class="n">net_learncf_1a</span><span class="p">,</span> <span class="s2">&quot;VpcId&quot;</span><span class="p">),</span>
        <span class="n">Tags</span><span class="o">=</span><span class="n">Tags</span><span class="p">(</span>
            <span class="n">Name</span><span class="o">=</span><span class="s2">&quot;learncf-1b&quot;</span><span class="p">,</span>
            <span class="n">Comment</span><span class="o">=</span><span class="s2">&quot;CloudFormation+Troposphere test&quot;</span><span class="p">))</span>

<span class="n">t</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">net_learncf_1b</span><span class="p">)</span>

<span class="c1"># Outputs section will export the subnet IDs to be used by other stacks</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/outputs-section-structure.html</span>
<span class="n">out_net_learncf_1a</span> <span class="o">=</span> <span class="n">Output</span><span class="p">(</span><span class="s2">&quot;outNetLearnCf1a&quot;</span><span class="p">)</span>

<span class="c1"># Ref is another CloudFormation intrinsic function:</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html</span>
<span class="c1"># If pointed to a subnet, Ref will return the subnet ID:</span>
<span class="c1"># https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html#aws-resource-ec2-subnet-ref</span>
<span class="n">out_net_learncf_1a</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Ref</span><span class="p">(</span><span class="n">net_learncf_1a</span><span class="p">)</span>
<span class="c1"># Append the subnet title (Logical ID) to the stack name and set that as the</span>
<span class="c1"># exported property. Importing it in another stack will return the Value</span>
<span class="c1"># we set above to that stack.</span>
<span class="c1">#</span>
<span class="c1"># Sub stands for &#39;substitute&#39;, another CloudFormation intrinsic function.</span>
<span class="n">out_net_learncf_1a</span><span class="o">.</span><span class="n">Export</span> <span class="o">=</span> <span class="n">Export</span><span class="p">(</span><span class="n">Sub</span><span class="p">(</span>
    <span class="s2">&quot;${AWS::StackName}-&quot;</span> <span class="o">+</span> <span class="n">net_learncf_1a</span><span class="o">.</span><span class="n">title</span><span class="p">))</span>

<span class="c1"># Similar output for the second subnet</span>
<span class="n">out_net_learncf_1b</span> <span class="o">=</span> <span class="n">Output</span><span class="p">(</span><span class="s2">&quot;outNetLearnCf1b&quot;</span><span class="p">)</span>
<span class="n">out_net_learncf_1b</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Ref</span><span class="p">(</span><span class="n">net_learncf_1b</span><span class="p">)</span>
<span class="n">out_net_learncf_1b</span><span class="o">.</span><span class="n">Export</span> <span class="o">=</span> <span class="n">Export</span><span class="p">(</span><span class="n">Sub</span><span class="p">(</span>
    <span class="s2">&quot;${AWS::StackName}-&quot;</span> <span class="o">+</span> <span class="n">net_learncf_1b</span><span class="o">.</span><span class="n">title</span><span class="p">))</span>

<span class="c1"># Add outputs to template</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="n">out_net_learncf_1a</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="n">out_net_learncf_1b</span><span class="p">)</span>

<span class="c1"># Finally, write the template to a file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;learncf-subnet.yaml&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">())</span>
</pre></div>
</div>
<p>And the EC2 instance template:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1">#</span>
<span class="c1"># learncf_ec2.py</span>
<span class="c1">#</span>
<span class="c1"># Generate a CloudFormation template that creates an EC2 instance in a</span>
<span class="c1"># subnet which was created previously by another template (learncf-subnet)</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">from</span> <span class="nn">troposphere</span> <span class="kn">import</span> <span class="n">ec2</span>
<span class="kn">from</span> <span class="nn">troposphere</span> <span class="kn">import</span> <span class="n">Tags</span><span class="p">,</span> <span class="n">ImportValue</span>
<span class="kn">from</span> <span class="nn">troposphere</span> <span class="kn">import</span> <span class="n">Template</span>

<span class="c1"># create the object that will generate our template</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Template</span><span class="p">()</span>

<span class="n">ec2_learncf_1a</span> <span class="o">=</span> <span class="n">ec2</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s2">&quot;ec2LearnCf1a&quot;</span><span class="p">)</span>
<span class="n">ec2_learncf_1a</span><span class="o">.</span><span class="n">ImageId</span> <span class="o">=</span> <span class="s2">&quot;ami-e487179d&quot;</span>                 <span class="c1"># ADJUST IF NEEDED</span>
<span class="n">ec2_learncf_1a</span><span class="o">.</span><span class="n">InstanceType</span> <span class="o">=</span> <span class="s2">&quot;t2.micro&quot;</span>
<span class="c1"># We set the subnet to start this instance in by importing the subnet ID</span>
<span class="c1"># from the other CloudFormation stack, which previously created it.</span>
<span class="c1"># An example of cross-stack reference used to split stacks into</span>
<span class="c1"># manageable pieces. Each export must have a unique name in its account</span>
<span class="c1"># and region, so the template name was prepended to the resource name.</span>
<span class="n">ec2_learncf_1a</span><span class="o">.</span><span class="n">SubnetId</span> <span class="o">=</span> <span class="n">ImportValue</span><span class="p">(</span><span class="s2">&quot;learncf-subnet-netLearnCf1a&quot;</span><span class="p">)</span>
<span class="n">ec2_learncf_1a</span><span class="o">.</span><span class="n">Tags</span> <span class="o">=</span> <span class="n">Tags</span><span class="p">(</span>
        <span class="n">Name</span><span class="o">=</span><span class="s2">&quot;learncf&quot;</span><span class="p">,</span>
        <span class="n">Comment</span><span class="o">=</span><span class="s2">&quot;Learning CloudFormation and Troposphere&quot;</span><span class="p">)</span>

<span class="n">t</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">ec2_learncf_1a</span><span class="p">)</span>

<span class="c1"># Finally, write the template to a file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;learncf-ec2.yaml&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">())</span>
</pre></div>
</div>
<p>After the .yaml files are generated using the code above stacks can be created
from the command line like this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>aws cloudformation create-stack --stack-name learncf-subnet --template-body file://learncf-subnet.yaml
aws cloudformation create-stack --stack-name learncf-ec2    --template-body file://learncf-ec2.yaml
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="apis/examples_toc.html" class="btn btn-neutral float-right" title="examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="troposphere" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, cloudtools

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>